<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.teamx.respets.dao.AdminDao">

	<!-- 관리자 로그인 -->
	<select id="adminLogin" parameterType="HashMap"
		resultType="HashMap">
		SELECT * FROM ADM WHERE ADM_NO=#{adm_no} AND
		ADM_PW=#{adm_pw}
	</select>
	
		<!-- 미인증 기업리스트 -->
	<select id="getBusinessList" resultType="HashMap">
		SELECT BUS.BUS_NO,
		BCT.BCT_NAME, SVC.BCT_CODE, BUS.BUS_EMAIL,
		BUS.BUS_NAME, BUS.BUS_CEO, BUS.BUS_LCNO, BUS.BUS_PHONE,
		BUS.BUS_ADDR, BUS.BUS_ADDR2, TO_CHAR(BUS.BUS_TIME, 'YYYY-MM-DD HH24:MI') AS BUS_TIME, SVC.SVC_PRI
		FROM BUS INNER JOIN SVC
		ON SVC.BUS_NO = BUS.BUS_NO
		INNER JOIN BCT
		ON SVC.BCT_CODE = BCT.BCT_CODE WHERE BUS.BUS_CHK = 'X' AND SVC.SVC_PRI=1
		ORDER BY BUS_TIME ASC
	</select>

	<!-- 미인증 기업리스트 정보 가져오기 -->
	<select id="getBusinessInfo" parameterType="HashMap"
		resultType="HashMap">
		SELECT BCT.BCT_NAME, BUS.BUS_NAME, BUS.BUS_PHONE, BUS.BUS_ADDR, BUS.BUS_ADDR2,
		BUS.BUS_EMAIL, GLR.GCT_NO, GLR.GLR_FILE, GLR.GLR_LOC, BUS.BUS_LCNO, BUS.BUS_CEO
		FROM BUS INNER JOIN SVC
		ON SVC.BUS_NO = BUS.BUS_NO
		INNER JOIN BCT
		ON SVC.BCT_CODE = BCT.BCT_CODE
		INNER JOIN GLR
		ON GLR.BUS_NO = BUS.BUS_NO
		WHERE BUS.BUS_NO=#{bus_no} AND SVC.BCT_CODE=#{bct_code} AND GLR.GCT_NO=1
	</select>
	
	<!-- 기업인증 -->
	<update id="confirmLicense" parameterType="String">
		UPDATE BUS SET
		BUS_CHK='O' WHERE BUS_NO=#{bus_no}
	</update>
	
</mapper>